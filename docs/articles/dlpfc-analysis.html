<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Human DLPFC 10x Visium analysis â€¢ Banksy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Human DLPFC 10x Visium analysis">
<meta property="og:description" content="Banksy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Banksy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/banksy-object.html">Working with BanksyObjects</a>
    </li>
    <li>
      <a href="../articles/hippocampus-analysis.html">Choosing clustering parameters (Mouse hippocampus VeraFISH)</a>
    </li>
    <li>
      <a href="../articles/dlpfc-analysis.html">Analysing multiple datasets (Human DLPFC 10x Visium)</a>
    </li>
    <li>
      <a href="../articles/hypothalamus-analysis.html">Visualization (Mouse hypothalamus MERFISH)</a>
    </li>
    <li>
      <a href="../articles/single-cell-exp.html">SingleCellExperiment interoperability</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/prabhakarlab/Banksy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Human DLPFC 10x Visium analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/prabhakarlab/Banksy/blob/HEAD/vignettes/dlpfc-analysis.Rmd" class="external-link"><code>vignettes/dlpfc-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>dlpfc-analysis.Rmd</code></div>

    </div>

    
    
<p>Here, we demonstrate BANKSY analysis on the human dorsolateral
prefrontal cortex 10x Visium data from Maynard et al (2018). The data
comprise 12 samples obtained from 3 subjects, with manual annotation of
the layers in each sample. Here, we demonstrate BANKSY analysis on
multiple datasets with 4 of the 12 samples in this dataset.</p>
<div class="section level2">
<h2 id="loading-the-data">Loading the data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<p>The package provides gene expression and spot locations for the
samples from subject 3 (sample 151673 - 151676). We processed the raw
data (obtained <a href="http://research.libd.org/spatialLIBD/" class="external-link">here</a>)
by first performing library size normalization. Next, we identified the
top 3000 highly variable genes for each sample. The union of these genes
were used as the gene set for downstream analysis. See
<code><a href="../reference/dlpfc151673.html">?Banksy::dlpfc151673</a></code> for more details.</p>
<p>Here, we load the data and construct the <em>BanksyObject</em>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/prabhakarlab/Banksy" class="external-link">Banksy</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dlpfc151673</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dlpfc151674</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dlpfc151675</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dlpfc151676</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dlpfc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dlpfc151673</span>, <span class="va">dlpfc151674</span>, <span class="va">dlpfc151675</span>, <span class="va">dlpfc151676</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dlpfc</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span><span class="va">locs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dlpfc</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">locations</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gcm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">locs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'sample_15167'</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BanksyObject-class.html">BanksyObject</a></span><span class="op">(</span>own.expr <span class="op">=</span> <span class="va">gcm</span>, cell.locs <span class="op">=</span> <span class="va">locs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bank</span></span></code></pre></div>
<pre><code><span><span class="co">## Object of class BanksyObject </span></span>
<span><span class="co">## Number of assays: 4</span></span>
<span><span class="co">## sample_151673: 3639 cells 7319 features</span></span>
<span><span class="co">## sample_151674: 3673 cells 7319 features</span></span>
<span><span class="co">## sample_151675: 3592 cells 7319 features</span></span>
<span><span class="co">## sample_151676: 3460 cells 7319 features</span></span>
<span><span class="co">## Spatial dimensions:</span></span>
<span><span class="co">## sample_151673: sdimx sdimy</span></span>
<span><span class="co">## sample_151674: sdimx sdimy</span></span>
<span><span class="co">## sample_151675: sdimx sdimy</span></span>
<span><span class="co">## sample_151676: sdimx sdimy</span></span>
<span><span class="co">## Metadata names: cell_ID dataset nCount NODG </span></span>
<span><span class="co">## Dimension reductions:</span></span></code></pre>
<p>Each processed sample contains roughly ~3,500 spots and 7,319
genes.</p>
</div>
<div class="section level2">
<h2 id="running-banksy">Running BANKSY<a class="anchor" aria-label="anchor" href="#running-banksy"></a>
</h2>
<details><summary><strong>Note</strong>
</summary><p>For brevity, the code chunks in this section are not run. The table
below shows the expected run time and memory requirements for the
following function calls:</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="25%">
<col width="27%">
<col width="28%">
</colgroup>
<thead><tr class="header">
<th align="left">Function call</th>
<th align="right">Elapsed time (sec)</th>
<th align="right">Total RAM used (MiB)</th>
<th align="right">Peaked RAM used (MiB)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ComputeBanksy</td>
<td align="right">8.14</td>
<td align="right">803.3</td>
<td align="right">2423.3</td>
</tr>
<tr class="even">
<td align="left">ScaleBanksy</td>
<td align="right">14.42</td>
<td align="right">0.1</td>
<td align="right">2621.0</td>
</tr>
<tr class="odd">
<td align="left">RunPCA</td>
<td align="right">299.67</td>
<td align="right">6.0</td>
<td align="right">6002.2</td>
</tr>
<tr class="even">
<td align="left">ClusterBanksy</td>
<td align="right">18.81</td>
<td align="right">32.9</td>
<td align="right">380.4</td>
</tr>
</tbody>
</table></details><p>We run BANKSY by first computing the neighbor-augmented matrix. We
use <code>k_geom=6</code>, which corresponds to the first order
neighbors for 10x Visium data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ComputeBanksy.html">ComputeBanksy</a></span><span class="op">(</span><span class="va">bank</span>, k_geom <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>We use <code>lambda=0.2</code>, and compute 25 PCs on the scale
BANKSY matrix:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ScaleBanksy.html">ScaleBanksy</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RunBanksyPCA.html">RunBanksyPCA</a></span><span class="op">(</span><span class="va">bank</span>, lambda <span class="op">=</span> <span class="fl">0.2</span>, npcs <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we perform Leiden clustering on 25 PCs:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ClusterBanksy.html">ClusterBanksy</a></span><span class="op">(</span><span class="va">bank</span>, M<span class="op">=</span><span class="fl">0</span>, lambda <span class="op">=</span> <span class="fl">0.2</span>, pca <span class="op">=</span> <span class="cn">TRUE</span>, npcs <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                      k.neighbors <span class="op">=</span> <span class="fl">40</span>, resolution <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="assessing-clustering-output">Assessing clustering output<a class="anchor" aria-label="anchor" href="#assessing-clustering-output"></a>
</h2>
<p>To assess BANKSY clustering output, we load manual annotation for
each sample and add it to the <em>BanksyObject</em>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Manual annotation is provided with the package</span></span>
<span><span class="va">anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/dlpfc_annotation.rds'</span>, package <span class="op">=</span> <span class="st">'Banksy'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'L1'</span>,<span class="st">'L2'</span>,<span class="st">'L3'</span>,<span class="st">'L4'</span>,<span class="st">'L5'</span>,<span class="st">'L6'</span>,<span class="st">'WM'</span>,<span class="st">'NA'</span><span class="op">)</span></span>
<span><span class="va">anno</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">anno</span>, from <span class="op">=</span> <span class="va">layers</span>, to <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add manual annotation the the BanksyObject</span></span>
<span><span class="fu"><a href="../reference/BanksyObject-class.html">meta.data</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span><span class="op">$</span><span class="va">clust_anno</span> <span class="op">&lt;-</span> <span class="va">anno</span></span></code></pre></div>
<p>Here, we visualise the UMAP for the spots from all samples combined,
overlayed with BANKSY clusters and manual annotation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/plotReduction.html">plotReduction</a></span><span class="op">(</span><span class="va">bank</span>, reduction <span class="op">=</span> <span class="st">'umap_M0_lam0.2'</span>, by <span class="op">=</span> <span class="st">'clust_M0_lam0.2_k40_res0.5'</span>, type <span class="op">=</span> <span class="st">'discrete'</span>,</span>
<span>                main <span class="op">=</span> <span class="st">'BANKSY clusters'</span>, main.size <span class="op">=</span> <span class="fl">10</span>, pt.size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="../reference/plotReduction.html">plotReduction</a></span><span class="op">(</span><span class="va">bank</span>, reduction <span class="op">=</span> <span class="st">'umap_M0_lam0.2'</span>, by <span class="op">=</span> <span class="st">'clust_anno'</span>, type <span class="op">=</span> <span class="st">'discrete'</span>,</span>
<span>                main <span class="op">=</span> <span class="st">'Manual annotation'</span>, main.size <span class="op">=</span> <span class="fl">10</span>, pt.size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">layers</span>, values <span class="op">=</span> <span class="fu">Banksy</span><span class="fu">:::</span><span class="fu">getPalette</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dlpfc-analysis_files/figure-html/umap-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Next, we compare BANKSY clusters against the manual annotation by
computing the adjusted Rand index for each sample and visualising the
spatial plots:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="../reference/BanksyObject-class.html">meta.data</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span><span class="op">$</span><span class="va">dataset</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get labels for each sample separately</span></span>
<span><span class="va">sample_banksy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="../reference/BanksyObject-class.html">meta.data</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span><span class="op">$</span><span class="va">clust_M0_lam0.2_k40_res0.5</span>, <span class="fu"><a href="../reference/BanksyObject-class.html">meta.data</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span><span class="op">$</span><span class="va">dataset</span><span class="op">)</span></span>
<span><span class="va">sample_anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="../reference/BanksyObject-class.html">meta.data</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span><span class="op">$</span><span class="va">clust_anno</span>, <span class="fu"><a href="../reference/BanksyObject-class.html">meta.data</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span><span class="op">$</span><span class="va">dataset</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute the ARI for each sample</span></span>
<span><span class="va">sample_ari</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">mclust</span><span class="fu">::</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html" class="external-link">adjustedRandIndex</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                  <span class="va">sample_banksy</span>, <span class="va">sample_anno</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate plots</span></span>
<span><span class="va">sample_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpatial.html">plotSpatial</a></span><span class="op">(</span><span class="va">bank</span>, dataset <span class="op">=</span> <span class="va">x</span>, by <span class="op">=</span> <span class="st">'clust_anno'</span>, type <span class="op">=</span> <span class="st">'discrete'</span>,</span>
<span>                main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'Sample %s'</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'sample_'</span>, <span class="st">''</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                main.size <span class="op">=</span> <span class="fl">10</span>, pt.size <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSpatial.html">plotSpatial</a></span><span class="op">(</span><span class="va">bank</span>, dataset <span class="op">=</span> <span class="va">x</span>, by <span class="op">=</span> <span class="st">'clust_M0_lam0.2_k40_res0.5'</span>, type <span class="op">=</span> <span class="st">'discrete'</span>,</span>
<span>                main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">'BANKSY ARI: %s'</span>, <span class="va">y</span><span class="op">)</span>,</span>
<span>                main.size <span class="op">=</span> <span class="fl">10</span>, pt.size <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  <span class="va">sample_names</span>, <span class="va">sample_ari</span><span class="op">)</span></span>
<span><span class="va">sample_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">sample_plots</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  grobs <span class="op">=</span> <span class="va">sample_plots</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  layout_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dlpfc-analysis_files/figure-html/plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<details><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Sonoma 14.2.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/London</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] plyr_1.8.9    ggplot2_3.4.4 gridExtra_2.3 Banksy_0.1.5 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] bitops_1.0-7                rlang_1.1.3                </span></span>
<span><span class="co">##   [3] magrittr_2.0.3              clue_0.3-65                </span></span>
<span><span class="co">##   [5] GetoptLong_1.0.5            matrixStats_1.2.0          </span></span>
<span><span class="co">##   [7] compiler_4.3.2              sccore_1.0.4               </span></span>
<span><span class="co">##   [9] png_0.1-8                   systemfonts_1.0.5          </span></span>
<span><span class="co">##  [11] vctrs_0.6.5                 maps_3.4.2                 </span></span>
<span><span class="co">##  [13] ggalluvial_0.12.5           stringr_1.5.1              </span></span>
<span><span class="co">##  [15] pkgconfig_2.0.3             shape_1.4.6                </span></span>
<span><span class="co">##  [17] crayon_1.5.2                fastmap_1.1.1              </span></span>
<span><span class="co">##  [19] XVector_0.42.0              labeling_0.4.3             </span></span>
<span><span class="co">##  [21] utf8_1.2.4                  rmarkdown_2.25             </span></span>
<span><span class="co">##  [23] ragg_1.2.7                  purrr_1.0.2                </span></span>
<span><span class="co">##  [25] xfun_0.42                   zlibbioc_1.48.0            </span></span>
<span><span class="co">##  [27] cachem_1.0.8                pals_1.8                   </span></span>
<span><span class="co">##  [29] GenomeInfoDb_1.38.6         jsonlite_1.8.8             </span></span>
<span><span class="co">##  [31] progress_1.2.3              highr_0.10                 </span></span>
<span><span class="co">##  [33] DelayedArray_0.28.0         prettyunits_1.2.0          </span></span>
<span><span class="co">##  [35] irlba_2.3.5.1               parallel_4.3.2             </span></span>
<span><span class="co">##  [37] cluster_2.1.6               R6_2.5.1                   </span></span>
<span><span class="co">##  [39] bslib_0.6.1                 stringi_1.8.3              </span></span>
<span><span class="co">##  [41] RColorBrewer_1.1-3          leidenAlg_1.1.2            </span></span>
<span><span class="co">##  [43] GenomicRanges_1.54.1        jquerylib_0.1.4            </span></span>
<span><span class="co">##  [45] Rcpp_1.0.12                 SummarizedExperiment_1.32.0</span></span>
<span><span class="co">##  [47] iterators_1.0.14            knitr_1.45                 </span></span>
<span><span class="co">##  [49] IRanges_2.36.0              Matrix_1.6-5               </span></span>
<span><span class="co">##  [51] igraph_2.0.1.1              tidyselect_1.2.0           </span></span>
<span><span class="co">##  [53] rstudioapi_0.15.0           dichromat_2.0-0.1          </span></span>
<span><span class="co">##  [55] abind_1.4-5                 yaml_2.3.8                 </span></span>
<span><span class="co">##  [57] doParallel_1.0.17           codetools_0.2-19           </span></span>
<span><span class="co">##  [59] lattice_0.22-5              tibble_3.2.1               </span></span>
<span><span class="co">##  [61] withr_3.0.0                 Biobase_2.62.0             </span></span>
<span><span class="co">##  [63] evaluate_0.23               desc_1.4.3                 </span></span>
<span><span class="co">##  [65] circlize_0.4.15             mclust_6.0.1               </span></span>
<span><span class="co">##  [67] pillar_1.9.0                MatrixGenerics_1.14.0      </span></span>
<span><span class="co">##  [69] foreach_1.5.2               stats4_4.3.2               </span></span>
<span><span class="co">##  [71] generics_0.1.3              dbscan_1.1-12              </span></span>
<span><span class="co">##  [73] RCurl_1.98-1.14             S4Vectors_0.40.2           </span></span>
<span><span class="co">##  [75] hms_1.1.3                   munsell_0.5.0              </span></span>
<span><span class="co">##  [77] scales_1.3.0                glue_1.7.0                 </span></span>
<span><span class="co">##  [79] mapproj_1.2.11              tools_4.3.2                </span></span>
<span><span class="co">##  [81] data.table_1.15.0           fs_1.6.3                   </span></span>
<span><span class="co">##  [83] grid_4.3.2                  colorspace_2.1-0           </span></span>
<span><span class="co">##  [85] GenomeInfoDbData_1.2.11     RcppHungarian_0.3          </span></span>
<span><span class="co">##  [87] cli_3.6.2                   textshaping_0.3.7          </span></span>
<span><span class="co">##  [89] fansi_1.0.6                 S4Arrays_1.2.0             </span></span>
<span><span class="co">##  [91] ComplexHeatmap_2.18.0       dplyr_1.1.4                </span></span>
<span><span class="co">##  [93] uwot_0.1.16                 gtable_0.3.4               </span></span>
<span><span class="co">##  [95] sass_0.4.8                  digest_0.6.34              </span></span>
<span><span class="co">##  [97] BiocGenerics_0.48.1         SparseArray_1.2.4          </span></span>
<span><span class="co">##  [99] farver_2.1.1                rjson_0.2.21               </span></span>
<span><span class="co">## [101] memoise_2.0.1               htmltools_0.5.7            </span></span>
<span><span class="co">## [103] pkgdown_2.0.7               lifecycle_1.0.4            </span></span>
<span><span class="co">## [105] GlobalOptions_0.1.2</span></span></code></pre>
</details>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vipul Singhal, Joseph Lee.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
