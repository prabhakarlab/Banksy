<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial transcriptomic clustering • Banksy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Spatial transcriptomic clustering">
<meta property="og:description" content="Banksy is an R package that incorporates spatial information to 
    cluster cells in a feature space (e.g. gene expression). To incorporate 
    spatial information, BANKSY computes the mean neighborhood expression and 
    azimuthal Gabor filters that capture gene expression gradients. These 
    features are combined with the cell's own expression to embed cells in a 
    neighbor-augmented product space which can then be clustered, allowing for
    accurate and spatially-aware cell typing and tissue domain segmentation. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">Banksy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/banksy-object.html">Working with BanksyObjects</a>
    </li>
    <li>
      <a href="articles/hippocampus-analysis.html">Choosing clustering parameters (Mouse hippocampus VeraFISH)</a>
    </li>
    <li>
      <a href="articles/dlpfc-analysis.html">Analysing multiple datasets (Human DLPFC 10x Visium)</a>
    </li>
    <li>
      <a href="articles/hypothalamus-analysis.html">Visualization (Mouse hypothalamus MERFISH)</a>
    </li>
    <li>
      <a href="articles/single-cell-exp.html">SingleCellExperiment interoperability</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/prabhakarlab/Banksy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>BANKSY is a method for clustering spatial transcriptomic data by augmenting the transcriptomic profile of each cell with an average of the transcriptomes of its spatial neighbors. By incorporating neighborhood information for clustering, BANKSY is able to</p>
<ul>
<li>improve cell-type assignment in noisy data</li>
<li>distinguish subtly different cell-types stratified by microenvironment</li>
<li>identify spatial zones sharing the same microenvironment</li>
</ul>
<p>BANKSY is applicable to a wide array of spatial technologies (e.g. 10x Visium, Slide-seq, MERFISH) and scales well to large datasets. For more details, check out:</p>
<ul>
<li>the <a href="https://www.biorxiv.org/content/10.1101/2022.04.14.488259v1" class="external-link">preprint</a>,</li>
<li>a <a href="https://twitter.com/vipul1891/status/1515323372535644166?s=20&amp;t=Bc6rz8VeWWptF67FejGYfQ" class="external-link">tweetorial</a> on BANKSY,</li>
<li>and a <a href="https://github.com/prabhakarlab/Banksy_py" class="external-link">Python version</a> of this package.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The <em>Banksy</em> package can be installed via <code>remotes</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"prabhakarlab/Banksy"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Installation should take less than three minutes.</p>
<p><strong>Known installation issues</strong></p>
<ol style="list-style-type: decimal">
<li>Installation of <code>leidenAlg</code> has non-zero exit status</li>
</ol>
<ul>
<li>Refer to the <a href="https://github.com/kharchenkolab/leidenAlg#installation" class="external-link">package website</a> for <em>leidenAlg</em> installation details. Otherwise, users may also install a separate branch of <em>Banksy</em> with</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"prabhakarlab/Banksy@feat-igraph-leiden"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Detailed description of <em>Banksy</em> functionality and example analyses are available at the <a href="https://prabhakarlab.github.io/Banksy/">package webpage</a>.</p>
<p><em>Banksy</em> comes installed with <a href="https://prabhakarlab.github.io/Banksy/reference/index.html">documentation</a> of main functions and their usage, along with several vignettes which detail different use cases:</p>
<ul>
<li><p><a href="https://prabhakarlab.github.io/Banksy/articles/banksy-object.html">Working with Banksy objects</a>: Introduction to the <em>BanksyObject</em> class which serves as a container for <em>Banksy</em>.</p></li>
<li><p><a href="https://prabhakarlab.github.io/Banksy/articles/hippocampus-analysis.html">Mouse hippocampus VeraFISH dataset</a>: Illustrates a grid search of parameters which best cluster cells.</p></li>
<li><p><a href="https://prabhakarlab.github.io/Banksy/articles/dlpfc-analysis.html">Human dorsolateral prefrontal cortex 10x Visium dataset</a>: Illustrates analysis of multiple spatial transcriptomic datasets.</p></li>
<li><p><a href="https://prabhakarlab.github.io/Banksy/articles/hypothalamus-analysis.html">Mouse hypothalamus MERFISH dataset</a>: Illustrates visualization functionality with a dataset with 3 spatial dimensions.</p></li>
<li><p><a href="https://prabhakarlab.github.io/Banksy/articles/single-cell-exp.html">Interoperability with SingleCellExperiment</a>: Illustrates BANKSY interoperability with Bioconductor <a href="https://bioconductor.org/packages/release/bioc/html/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a> framework for interfacing with packages like <a href="https://bioconductor.org/packages/release/bioc/html/scran.html" class="external-link">scran</a> or <a href="https://bioconductor.org/packages/release/bioc/html/scater.html" class="external-link">scater</a>.</p></li>
</ul>
<p><em>Banksy</em> is also interoperable with <a href="https://satijalab.org/seurat/" class="external-link">Seurat</a> via <em>SeuratWrappers</em>. Documentation on how to run BANKSY on Seurat objects can be found <a href="https://github.com/satijalab/seurat-wrappers/blob/master/docs/banksy.md" class="external-link">here</a>. For installation of <em>SeuratWrappers</em> with the latest BANKSY version, run</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'jleechung/seurat-wrappers'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p><em>Banksy</em> takes as input an expression matrix and cell centroids. Example datasets are provided with the package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/prabhakarlab/Banksy" class="external-link">Banksy</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hippocampus</span><span class="op">)</span></span>
<span><span class="va">expr</span> <span class="op">&lt;-</span> <span class="va">hippocampus</span><span class="op">$</span><span class="va">expression</span></span>
<span><span class="va">locs</span> <span class="op">&lt;-</span> <span class="va">hippocampus</span><span class="op">$</span><span class="va">locations</span></span></code></pre></div>
<p>The gene expression matrix for cells should be a <code>matrix</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "matrix" "array"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">expr</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         cell_1276 cell_8890 cell_691 cell_396 cell_9818</span></span>
<span><span class="co">#&gt; Sparcl1        45         0       11       22         0</span></span>
<span><span class="co">#&gt; Slc1a2         17         0        6        5         0</span></span>
<span><span class="co">#&gt; Map            10         0       12       16         0</span></span>
<span><span class="co">#&gt; Sqstm1         26         0        0        2         0</span></span>
<span><span class="co">#&gt; Atp1a2          0         0        4        3         0</span></span>
<span><span class="co">#&gt; Tnc             0         0        0        0         0</span></span></code></pre></div>
<p>while cell locations should be supplied as a <code>data.frame</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">locs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "data.frame"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">locs</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 sdimx    sdimy</span></span>
<span><span class="co">#&gt; cell_1276  -13372.899 15776.37</span></span>
<span><span class="co">#&gt; cell_8890    8941.101 15866.37</span></span>
<span><span class="co">#&gt; cell_691   -14882.899 15896.37</span></span>
<span><span class="co">#&gt; cell_396   -15492.899 15835.37</span></span>
<span><span class="co">#&gt; cell_9818   11308.101 15846.37</span></span>
<span><span class="co">#&gt; cell_11310  14894.101 15810.37</span></span></code></pre></div>
<p>Next, create a <em>BanksyObject</em> with the expression matrix and cell locations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/BanksyObject-class.html">BanksyObject</a></span><span class="op">(</span>own.expr <span class="op">=</span> <span class="va">expr</span>,</span>
<span>                     cell.locs <span class="op">=</span> <span class="va">locs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="co">#&gt; own expression:</span></span>
<span><span class="co">#&gt;         cell_1276 cell_8890 cell_691 cell_396 cell_9818</span></span>
<span><span class="co">#&gt; Sparcl1        45         0       11       22         0</span></span>
<span><span class="co">#&gt; Slc1a2         17         0        6        5         0</span></span>
<span><span class="co">#&gt; Map            10         0       12       16         0</span></span>
<span><span class="co">#&gt; Sqstm1         26         0        0        2         0</span></span>
<span><span class="co">#&gt; Atp1a2          0         0        4        3         0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; neighbour expression:</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; cell locations:</span></span>
<span><span class="co">#&gt;                sdimx    sdimy</span></span>
<span><span class="co">#&gt; cell_1276 -13372.899 15776.37</span></span>
<span><span class="co">#&gt; cell_8890   8941.101 15866.37</span></span>
<span><span class="co">#&gt; cell_691  -14882.899 15896.37</span></span>
<span><span class="co">#&gt; cell_396  -15492.899 15835.37</span></span>
<span><span class="co">#&gt; cell_9818  11308.101 15846.37</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; metadata:</span></span>
<span><span class="co">#&gt;             cell_ID nCount NODG</span></span>
<span><span class="co">#&gt; cell_1276 cell_1276    266   51</span></span>
<span><span class="co">#&gt; cell_8890 cell_8890     13    3</span></span>
<span><span class="co">#&gt; cell_691   cell_691    132   36</span></span>
<span><span class="co">#&gt; cell_396   cell_396     95   27</span></span>
<span><span class="co">#&gt; cell_9818 cell_9818     10    5</span></span></code></pre></div>
<p>Apply basic QC by keeping only cells with total counts within the 5th and 98th percentile:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SubsetBanksy.html">SubsetBanksy</a></span><span class="op">(</span><span class="va">bank</span>, metadata <span class="op">=</span> <span class="va">nCount</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">nCount</span>, <span class="fl">0.05</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                                      <span class="va">nCount</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">nCount</span>, <span class="fl">0.98</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We first normalize the expression matrix, compute the neighbor matrix, and scale the resulting matrices.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/NormalizeBanksy.html">NormalizeBanksy</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ComputeBanksy.html">ComputeBanksy</a></span><span class="op">(</span><span class="va">bank</span>, k_geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing neighbors...</span></span>
<span><span class="co">#&gt; Spatial mode is kNN median</span></span>
<span><span class="co">#&gt; Parameters: k_geom = 15</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; Computing neighbors...</span></span>
<span><span class="co">#&gt; Spatial mode is kNN median</span></span>
<span><span class="co">#&gt; Parameters: k_geom = 30</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; Computing harmonic m = 0</span></span>
<span><span class="co">#&gt; Using 15 neighbors</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="co">#&gt; Computing harmonic m = 1</span></span>
<span><span class="co">#&gt; Using 30 neighbors</span></span>
<span><span class="co">#&gt; Centering</span></span>
<span><span class="co">#&gt; Done</span></span>
<span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ScaleBanksy.html">ScaleBanksy</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span></span></code></pre></div>
<p>Run PCA on the BANKSY matrix for <code>lambda=0</code> (no spatial information) and <code>lambda=0.2</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/RunBanksyPCA.html">RunBanksyPCA</a></span><span class="op">(</span><span class="va">bank</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running PCA for M=1 lambda=0</span></span>
<span><span class="co">#&gt; BANKSY matrix with own.expr, F0, F1</span></span>
<span><span class="co">#&gt; Squared lambdas: 1, 0, 0</span></span>
<span><span class="co">#&gt; Running PCA for M=1 lambda=0.2</span></span>
<span><span class="co">#&gt; BANKSY matrix with own.expr, F0, F1</span></span>
<span><span class="co">#&gt; Squared lambdas: 0.8, 0.1333, 0.0667</span></span></code></pre></div>
<p>Next, we obtain cluster assignments using graph-based clustering with the Leiden algorithm on the first 20 PCs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ClusterBanksy.html">ClusterBanksy</a></span><span class="op">(</span><span class="va">bank</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>, pca <span class="op">=</span> <span class="cn">TRUE</span>, npcs <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">'leiden'</span>, resolution <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p>Different clustering runs can be harmonised with <code>ConnectClusters</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ConnectClusters.html">ConnectClusters</a></span><span class="op">(</span><span class="va">bank</span>, map.to <span class="op">=</span> <span class="fu"><a href="reference/BanksyObject-class.html">clust.names</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Visualise the clustering output for non-spatial clustering (<code>lambda=0</code>) and BANKSY clustering (<code>lambda=0.2</code>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/BanksyObject-class.html">clust.names</a></span><span class="op">(</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">feature.types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'discrete'</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">main</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Non-spatial'</span>, <span class="st">'BANKSY'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotSpatialFeatures.html">plotSpatialFeatures</a></span><span class="op">(</span><span class="va">bank</span>, by <span class="op">=</span> <span class="va">features</span>, type <span class="op">=</span> <span class="va">feature.types</span>, main <span class="op">=</span> <span class="va">main</span>, </span>
<span>                    pt.size <span class="op">=</span> <span class="fl">1.5</span>, main.size <span class="op">=</span> <span class="fl">15</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%"></p>
<p>For clarity, we can visualise each of the clusters separately with <code>wrap = TRUE</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotSpatialFeatures.html">plotSpatialFeatures</a></span><span class="op">(</span><span class="va">bank</span>, by <span class="op">=</span> <span class="va">features</span>, type <span class="op">=</span> <span class="va">feature.types</span>, main <span class="op">=</span> <span class="va">main</span>, </span>
<span>                    pt.size <span class="op">=</span> <span class="fl">1</span>, main.size <span class="op">=</span> <span class="fl">15</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                    wrap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
<details><summary>
Runtime for analysis
</summary><div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time difference of 1.918232 mins</span></span></code></pre></div>
</details><details><summary>
Session information
</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.1 (2022-06-23 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Windows 10 x64 (build 19043)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=English_Singapore.utf8  LC_CTYPE=English_Singapore.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=English_Singapore.utf8 LC_NUMERIC=C                      </span></span>
<span><span class="co">#&gt; [5] LC_TIME=English_Singapore.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] Banksy_0.1.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] bitops_1.0-7                matrixStats_0.62.0         </span></span>
<span><span class="co">#&gt;  [3] doParallel_1.0.17           RColorBrewer_1.1-3         </span></span>
<span><span class="co">#&gt;  [5] progress_1.2.2              GenomeInfoDb_1.34.4        </span></span>
<span><span class="co">#&gt;  [7] tools_4.2.1                 utf8_1.2.2                 </span></span>
<span><span class="co">#&gt;  [9] R6_2.5.1                    irlba_2.3.5.1              </span></span>
<span><span class="co">#&gt; [11] uwot_0.1.14                 DBI_1.1.3                  </span></span>
<span><span class="co">#&gt; [13] BiocGenerics_0.44.0         colorspace_2.0-3           </span></span>
<span><span class="co">#&gt; [15] GetoptLong_1.0.5            withr_2.5.0                </span></span>
<span><span class="co">#&gt; [17] tidyselect_1.2.0            gridExtra_2.3              </span></span>
<span><span class="co">#&gt; [19] prettyunits_1.1.1           compiler_4.2.1             </span></span>
<span><span class="co">#&gt; [21] cli_3.4.1                   Biobase_2.58.0             </span></span>
<span><span class="co">#&gt; [23] DelayedArray_0.24.0         labeling_0.4.2             </span></span>
<span><span class="co">#&gt; [25] scales_1.2.1                stringr_1.5.0              </span></span>
<span><span class="co">#&gt; [27] digest_0.6.30               dbscan_1.1-11              </span></span>
<span><span class="co">#&gt; [29] rmarkdown_2.19              XVector_0.38.0             </span></span>
<span><span class="co">#&gt; [31] dichromat_2.0-0.1           pkgconfig_2.0.3            </span></span>
<span><span class="co">#&gt; [33] htmltools_0.5.4             MatrixGenerics_1.10.0      </span></span>
<span><span class="co">#&gt; [35] highr_0.10                  fastmap_1.1.0              </span></span>
<span><span class="co">#&gt; [37] maps_3.4.1                  rlang_1.0.6                </span></span>
<span><span class="co">#&gt; [39] GlobalOptions_0.1.2         pals_1.7                   </span></span>
<span><span class="co">#&gt; [41] rstudioapi_0.14             farver_2.1.1               </span></span>
<span><span class="co">#&gt; [43] shape_1.4.6                 generics_0.1.3             </span></span>
<span><span class="co">#&gt; [45] mclust_6.0.0                dplyr_1.0.10               </span></span>
<span><span class="co">#&gt; [47] RCurl_1.98-1.9              magrittr_2.0.3             </span></span>
<span><span class="co">#&gt; [49] GenomeInfoDbData_1.2.9      Matrix_1.5-3               </span></span>
<span><span class="co">#&gt; [51] Rcpp_1.0.9                  munsell_0.5.0              </span></span>
<span><span class="co">#&gt; [53] S4Vectors_0.36.0            fansi_1.0.3                </span></span>
<span><span class="co">#&gt; [55] lifecycle_1.0.3             stringi_1.7.8              </span></span>
<span><span class="co">#&gt; [57] leidenAlg_1.0.5             yaml_2.3.6                 </span></span>
<span><span class="co">#&gt; [59] ggalluvial_0.12.3           SummarizedExperiment_1.28.0</span></span>
<span><span class="co">#&gt; [61] zlibbioc_1.44.0             plyr_1.8.8                 </span></span>
<span><span class="co">#&gt; [63] grid_4.2.1                  parallel_4.2.1             </span></span>
<span><span class="co">#&gt; [65] crayon_1.5.2                lattice_0.20-45            </span></span>
<span><span class="co">#&gt; [67] sccore_1.0.2                mapproj_1.2.9              </span></span>
<span><span class="co">#&gt; [69] circlize_0.4.15             hms_1.1.2                  </span></span>
<span><span class="co">#&gt; [71] knitr_1.41                  ComplexHeatmap_2.14.0      </span></span>
<span><span class="co">#&gt; [73] pillar_1.8.1                igraph_1.3.5               </span></span>
<span><span class="co">#&gt; [75] GenomicRanges_1.50.1        rjson_0.2.21               </span></span>
<span><span class="co">#&gt; [77] codetools_0.2-18            stats4_4.2.1               </span></span>
<span><span class="co">#&gt; [79] glue_1.6.2                  evaluate_0.19              </span></span>
<span><span class="co">#&gt; [81] data.table_1.14.6           png_0.1-7                  </span></span>
<span><span class="co">#&gt; [83] vctrs_0.5.1                 foreach_1.5.2              </span></span>
<span><span class="co">#&gt; [85] gtable_0.3.1                clue_0.3-62                </span></span>
<span><span class="co">#&gt; [87] assertthat_0.2.1            ggplot2_3.4.0              </span></span>
<span><span class="co">#&gt; [89] xfun_0.36                   tibble_3.1.8               </span></span>
<span><span class="co">#&gt; [91] RcppHungarian_0.2           iterators_1.0.14           </span></span>
<span><span class="co">#&gt; [93] IRanges_2.32.0              cluster_2.1.4              </span></span>
<span><span class="co">#&gt; [95] ellipsis_0.3.2</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Bug reports, questions, request for enhancements or other contributions can be raised at the <a href="https://github.com/prabhakarlab/Banksy/issues" class="external-link">issue page</a>.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/prabhakarlab/Banksy/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Banksy</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vipul Singhal <br><small class="roles"> Author </small>  </li>
<li>Joseph Lee <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Vipul Singhal, Joseph Lee.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
